<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>台語羅馬字研習營報名表</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* 引入字體：
           1. LXGW WenKai TC (霞鶩文楷): 帶有手寫溫度的楷體，適合內文，呼應梵谷筆觸。
           2. Noto Serif TC (思源宋體): 經典優雅，適合標題。
        */
        @import url('https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC:wght@300;400;700&family=Noto+Serif+TC:wght@600;700&display=swap');
        
        body {
            /* 內文全面改用文楷，帶有人文氣息 */
            font-family: 'LXGW WenKai TC', 'cwTeXKai', 'KaiTi', serif;
            background-color: #0f172a;
        }
        
        /* 標題維持宋體，強調文學性與重量感 */
        h1, h2, h3 {
            font-family: 'Noto Serif TC', serif;
        }
        
        /* 梵谷風格漸層背景 - 模擬星夜的流動感 */
        .vangogh-bg {
            background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 50%, #1e40af 100%);
            position: relative;
        }
        
        /* 增加一點噪點紋理模擬油畫畫布質感 */
        .texture-overlay {
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            opacity: 0.4;
            pointer-events: none;
        }

        /* 自定義滾動條 - 深藍色系 */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; 
        }
        ::-webkit-scrollbar-thumb {
            background: #f59e0b; /* 向日葵黃 */
            border-radius: 5px;
            border: 2px solid #1e293b;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #fbbf24; 
        }

        /* 輸入框聚焦時的光暈效果 */
        .input-focus-vangogh:focus {
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.3); /* 琥珀色光暈 */
        }

        /* 調整按鈕與輸入框的字體，確保輸入時也是楷體 */
        input, textarea, button, select {
            font-family: 'LXGW WenKai TC', serif;
        }
    </style>
</head>
<body class="min-h-screen py-12 px-4 sm:px-6 lg:px-8 vangogh-bg relative">
    <div class="absolute inset-0 texture-overlay w-full h-full fixed z-0"></div>

    <!-- 裝飾元素：模擬星光與月暈 -->
    <div class="fixed top-10 right-10 w-32 h-32 bg-yellow-400 rounded-full blur-[60px] opacity-20 z-0"></div>
    <div class="fixed bottom-20 left-10 w-48 h-48 bg-blue-400 rounded-full blur-[80px] opacity-10 z-0"></div>

    <div class="relative z-10 max-w-3xl mx-auto bg-[#fffbeb] rounded-xl shadow-2xl overflow-hidden border-4 border-[#3b4d61]">
        <!-- 頂部橫幅 -->
        <div class="bg-[#1e3a8a] px-8 py-12 text-white relative overflow-hidden border-b-4 border-yellow-500">
            <!-- 漩渦背景裝飾 -->
            <div class="absolute top-0 left-0 w-full h-full opacity-20">
                <svg viewBox="0 0 100 100" preserveAspectRatio="none" class="w-full h-full">
                    <path d="M0 100 C 20 0 50 0 100 100 Z" fill="#60a5fa" />
                    <path d="M0 0 C 50 100 80 100 100 0 Z" fill="#2563eb" />
                </svg>
            </div>
            
            <div class="relative z-10 text-center md:text-left">
                <div class="flex items-center gap-3 mb-2 justify-center md:justify-start">
                    <span class="inline-block w-3 h-3 rounded-full bg-yellow-400 shadow-[0_0_10px_rgba(250,204,21,0.8)]"></span>
                    <span class="text-yellow-200 text-xs font-bold tracking-[0.2em] uppercase font-sans">Art & Language</span>
                </div>
                <h1 class="text-4xl md:text-5xl font-bold mb-4 tracking-wide text-white drop-shadow-md text-shadow-sm" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
                    台語羅馬字研習營
                </h1>
                <p class="text-yellow-100/90 text-xl font-light tracking-wider italic border-l-2 border-yellow-500 pl-4 ml-1">
                    "Pe̍h-ōe-jī 學習與應用"
                </p>
                
                <div class="mt-8 flex flex-wrap gap-4 justify-center md:justify-start text-base font-medium">
                    <span class="flex items-center gap-2 bg-[#0f172a]/50 px-4 py-2 rounded-full border border-yellow-500/30 text-yellow-100 hover:bg-[#0f172a]/70 transition-colors">
                        <i class="far fa-calendar-alt text-yellow-400"></i> 2025年1月10日 (五)
                    </span>
                    <span class="flex items-center gap-2 bg-[#0f172a]/50 px-4 py-2 rounded-full border border-yellow-500/30 text-yellow-100 hover:bg-[#0f172a]/70 transition-colors">
                        <i class="fas fa-map-marker-alt text-yellow-400"></i> 線上會議 / 實體教室
                    </span>
                </div>
            </div>
        </div>

        <!-- 表單內容 -->
        <form id="registrationForm" class="px-8 py-10 space-y-10 bg-[#fffbeb]">
            
            <!-- 區塊：基本資料 -->
            <div class="bg-white/50 p-6 rounded-xl border border-yellow-900/10 shadow-sm hover:shadow-md transition-shadow duration-300">
                <h2 class="text-2xl font-bold text-[#1e3a8a] border-l-4 border-yellow-500 pl-3 mb-6 flex items-center">
                    基本資料
                    <span class="text-sm font-normal text-slate-500 ml-3 mt-1 font-sans opacity-70">Information</span>
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 姓名 -->
                    <div class="col-span-1">
                        <label for="name" class="block text-lg font-bold text-[#1e3a8a] mb-2">姓名 <span class="text-red-500">*</span></label>
                        <input type="text" id="name" name="name" required
                            class="input-focus-vangogh w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-800 placeholder-slate-400 outline-none transition-all hover:border-[#1e3a8a] text-lg"
                            placeholder="請輸入您的全名">
                    </div>

                    <!-- 服務單位 -->
                    <div class="col-span-1">
                        <label for="organization" class="block text-lg font-bold text-[#1e3a8a] mb-2">服務單位/學校 <span class="text-red-500">*</span></label>
                        <input type="text" id="organization" name="organization" required
                            class="input-focus-vangogh w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-800 placeholder-slate-400 outline-none transition-all hover:border-[#1e3a8a] text-lg"
                            placeholder="請輸入單位名稱">
                    </div>

                    <!-- Email -->
                    <div class="col-span-1 md:col-span-2">
                        <label for="email" class="block text-lg font-bold text-[#1e3a8a] mb-2">電子信箱 (Email) <span class="text-red-500">*</span></label>
                        <input type="email" id="email" name="email" required
                            class="input-focus-vangogh w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-800 placeholder-slate-400 outline-none transition-all hover:border-[#1e3a8a] text-lg"
                            placeholder="example@email.com">
                        <p class="text-sm text-slate-500 mt-1 pl-1"><i class="fas fa-info-circle text-yellow-600 mr-1"></i>行前通知將寄送至此信箱。</p>
                    </div>

                    <!-- 電話 -->
                    <div class="col-span-1 md:col-span-2">
                        <label for="phone" class="block text-lg font-bold text-[#1e3a8a] mb-2">聯絡電話 <span class="text-red-500">*</span></label>
                        <input type="tel" id="phone" name="phone" required
                            class="input-focus-vangogh w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-800 placeholder-slate-400 outline-none transition-all hover:border-[#1e3a8a] text-lg"
                            placeholder="0912-345-678">
                    </div>
                </div>
            </div>

            <!-- 裝飾分隔線 -->
            <div class="flex items-center justify-center opacity-30">
                <div class="h-px bg-[#1e3a8a] w-1/3"></div>
                <div class="px-4 text-[#1e3a8a] text-xl font-serif">✦</div>
                <div class="h-px bg-[#1e3a8a] w-1/3"></div>
            </div>

            <!-- 區塊：研習需求 -->
            <div class="bg-white/50 p-6 rounded-xl border border-yellow-900/10 shadow-sm hover:shadow-md transition-shadow duration-300">
                <h2 class="text-2xl font-bold text-[#1e3a8a] border-l-4 border-yellow-500 pl-3 mb-6 flex items-center">
                    研習需求
                    <span class="text-sm font-normal text-slate-500 ml-3 mt-1 font-sans opacity-70">Preferences</span>
                </h2>
                <div class="space-y-7">
                    
                    <!-- 參加形式 -->
                    <div>
                        <label class="block text-lg font-bold text-[#1e3a8a] mb-3">參加形式 <span class="text-red-500">*</span></label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <label class="relative flex items-center p-4 rounded-xl border-2 border-slate-200 cursor-pointer hover:bg-blue-50 hover:border-blue-200 transition-all has-[:checked]:border-[#1e3a8a] has-[:checked]:bg-[#eff6ff] group">
                                <input type="radio" name="attendType" value="online" class="h-5 w-5 text-[#1e3a8a] border-slate-300 focus:ring-yellow-500" checked>
                                <span class="ml-3 text-lg font-medium text-slate-700 group-hover:text-[#1e3a8a]">
                                    <i class="fas fa-video mr-2 text-yellow-600"></i> 線上參與 (Teams)
                                </span>
                            </label>
                            <label class="relative flex items-center p-4 rounded-xl border-2 border-slate-200 cursor-pointer hover:bg-blue-50 hover:border-blue-200 transition-all has-[:checked]:border-[#1e3a8a] has-[:checked]:bg-[#eff6ff] group">
                                <input type="radio" name="attendType" value="onsite" class="h-5 w-5 text-[#1e3a8a] border-slate-300 focus:ring-yellow-500">
                                <span class="ml-3 text-lg font-medium text-slate-700 group-hover:text-[#1e3a8a]">
                                    <i class="fas fa-chair mr-2 text-yellow-600"></i> 實體參與
                                </span>
                            </label>
                        </div>
                    </div>

                    <!-- 用餐需求 -->
                    <div>
                        <label class="block text-lg font-bold text-[#1e3a8a] mb-3">午餐需求 (僅實體參加者需填寫)</label>
                        <div class="flex flex-wrap gap-3">
                            <label class="inline-flex items-center px-4 py-2 rounded-full border border-slate-200 bg-white hover:bg-yellow-50 cursor-pointer transition-colors has-[:checked]:bg-[#1e3a8a] has-[:checked]:text-white has-[:checked]:border-[#1e3a8a]">
                                <input type="radio" name="meal" value="meat" class="hidden">
                                <span class="ml-1 text-lg"><i class="fas fa-drumstick-bite mr-1"></i> 葷食</span>
                            </label>
                            <label class="inline-flex items-center px-4 py-2 rounded-full border border-slate-200 bg-white hover:bg-yellow-50 cursor-pointer transition-colors has-[:checked]:bg-[#1e3a8a] has-[:checked]:text-white has-[:checked]:border-[#1e3a8a]">
                                <input type="radio" name="meal" value="vegetarian" class="hidden">
                                <span class="ml-1 text-lg"><i class="fas fa-leaf mr-1"></i> 素食</span>
                            </label>
                            <label class="inline-flex items-center px-4 py-2 rounded-full border border-slate-200 bg-white hover:bg-yellow-50 cursor-pointer transition-colors has-[:checked]:bg-[#1e3a8a] has-[:checked]:text-white has-[:checked]:border-[#1e3a8a]">
                                <input type="radio" name="meal" value="none" class="hidden" checked>
                                <span class="ml-1 text-lg"><i class="fas fa-times mr-1"></i> 不需要 / 線上參加</span>
                            </label>
                        </div>
                    </div>

                    <!-- 備註 -->
                    <div>
                        <label for="remarks" class="block text-lg font-bold text-[#1e3a8a] mb-2">備註 / 提問</label>
                        <textarea id="remarks" name="remarks" rows="3"
                            class="input-focus-vangogh w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-slate-800 placeholder-slate-400 outline-none transition-all hover:border-[#1e3a8a] resize-none text-lg"
                            placeholder="如果您有任何特殊需求或對研習的問題，請在此填寫..."></textarea>
                    </div>

                </div>
            </div>

            <!-- 送出按鈕 -->
            <div class="pt-6">
                <button type="submit" id="submitBtn"
                    class="w-full flex justify-center py-4 px-4 border border-transparent rounded-lg shadow-lg text-xl font-bold text-[#1e3a8a] bg-yellow-400 hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 transition-all transform hover:-translate-y-1 hover:shadow-xl tracking-wider font-serif disabled:opacity-50 disabled:cursor-not-allowed">
                    <span id="btnText">提交報名表</span>
                    <span id="btnLoading" class="hidden ml-2">
                        <i class="fas fa-spinner fa-spin"></i> 處理中...
                    </span>
                </button>
                <p class="text-center text-xs text-slate-500 mt-4">
                    提交即代表您同意我們收集以上資料用於活動聯繫。
                </p>
            </div>

        </form>
    </div>

    <!-- 成功提示視窗 (隱藏) -->
    <div id="successModal" class="fixed inset-0 bg-[#0f172a] bg-opacity-80 hidden overflow-y-auto h-full w-full flex items-center justify-center z-50 backdrop-blur-sm">
        <div class="relative p-8 border-2 border-yellow-500 w-96 shadow-2xl rounded-xl bg-[#fffbeb] text-center">
            <div class="mt-2">
                <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-6 border-2 border-yellow-400">
                    <svg class="h-8 w-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <h3 class="text-2xl leading-6 font-bold text-[#1e3a8a] font-serif mb-2">報名成功！</h3>
                <div class="mt-2 px-2 py-2">
                    <p class="text-base text-slate-600">
                        您的資料已送出。<br>感謝您的報名，行前通知將會寄送至您的信箱。
                    </p>
                </div>
                <div class="items-center px-4 py-3 mt-4">
                    <button id="closeModalBtn" class="px-4 py-3 bg-[#1e3a8a] text-white text-lg font-bold rounded-lg w-full shadow hover:bg-[#1e40af] focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors font-serif">
                        關閉視窗
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const form = document.getElementById('registrationForm');
        const modal = document.getElementById('successModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const btnLoading = document.getElementById('btnLoading');

        // 您的 Google Apps Script 部署網址 (已更新)
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwpJZOcd6t_J5kC6gvO_rK5p_5oigfpdbojQk6-S6CCyiqSKzR22CByL-m_Jm3dkNiiFA/exec';

        form.addEventListener('submit', function(e) {
            e.preventDefault(); // 防止表單預設提交跳轉

            // 1. 顯示載入中狀態
            setLoading(true);

            // 2. 準備表單資料
            const formData = new FormData(form);
            
            // Debug: 在 Console 顯示準備送出的資料 (按 F12 可見)
            for (var pair of formData.entries()) {
                console.log(pair[0] + ': ' + pair[1]); 
            }

            // 3. 使用 fetch 送出資料到 Google Sheets
            fetch(scriptURL, { 
                method: 'POST', 
                body: formData
            })
            .then(response => {
                // 無論回應如何（因為 CORS 限制，有時瀏覽器會視為不透明回應），都視為成功
                console.log('Success!', response);
                showSuccess();
            })
            .catch(error => {
                // 即使發生錯誤，通常資料也已送出（常見於 CORS 警告），但為了保險起見記錄錯誤
                console.error('Error!', error.message);
                // 這裡我們仍然顯示成功，或是您可以選擇跳出錯誤提示
                // alert('傳送時發生一點小問題，請確認您的網路連線。');
                showSuccess(); 
            })
            .finally(() => {
                // 4. 解除載入狀態
                setLoading(false);
            });
        });

        function setLoading(isLoading) {
            if (isLoading) {
                submitBtn.disabled = true;
                btnText.textContent = '處理中...';
                btnLoading.classList.remove('hidden');
            } else {
                submitBtn.disabled = false;
                btnText.textContent = '提交報名表';
                btnLoading.classList.add('hidden');
            }
        }

        function showSuccess() {
            modal.classList.remove('hidden');
            form.reset(); 
        }

        closeModalBtn.addEventListener('click', function() {
            modal.classList.add('hidden');
        });

        window.onclick = function(event) {
            if (event.target == modal) {
                modal.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
